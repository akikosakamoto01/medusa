<%= search_form_for @diff_search, url: diff_box_path(@box), remote: true, id: "diff_search" do |f| %>
  <div class="row">
    <div class="col-lg-1">
      <%= f.button class: "btn btn-default" do %>
	<span class="glyphicon glyphicon-refresh"></span>
      <% end %>
    </div>
    <div class="col-lg-2">
      <%= text_field_tag :src, format_date(params[:src]), placeholder: "source:", class: "form-control input-sm datepicker", maxlength: 10 %>
    </div>
    <div class="col-lg-2">
      <%= text_field_tag :dst, format_date(params[:dst]), placeholder: "destination:", class: "form-control input-sm datepicker", maxlength: 10 %>
    </div>
  </div>
  <table class="table table-condensed table-striped">
    <thead>
      <tr>
	<th></th>
	<th><%= sort_link @diff_search, :path, "path", { action: :diff }, remote: true %></th>
	<th>type</th>
	<th><%= sort_link @diff_search, :brought_in_at, "in", { action: :diff }, remote: true %></th>
	<th>out</th>
      </tr>
    </thead>
    <tbody>
      <% @diff.each do |path| %>
        <tr>
	  <td><%= path.sign %>
          <td><%= raw (path.map { |content| link_to_if(can?(:read, content), content.name, content) }).join("/") %></td>
          <td><%= path.datum_type %></td>
          <td><%= path.brought_in_at.strftime("%Y-%m-%d %H:%M") %></td> 
          <td><%= path.brought_out_at && path.brought_out_at.strftime("%Y-%m-%d %H:%M") %></td> 
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>
